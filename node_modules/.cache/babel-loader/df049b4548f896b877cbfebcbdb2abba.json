{"ast":null,"code":"var _jsxFileName = \"/Users/zhigangdeng/Projects/react-stock-dashboard/src/components/SearchCard.js\";\nimport React from 'react';\nimport stock from '../apis/stock';\nimport '../css/SearchCard.css';\nimport '../css/styles.css';\nimport { FaSearch } from 'react-icons/fa';\n\nclass SearchCard extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      search_stockArray: [],\n      loading_api: false\n    };\n\n    this.sendSearchResult = async (torf, value) => {\n      let stockValue;\n\n      if (torf) {\n        stockValue = document.querySelector(\".stock-code__value\").value.toUpperCase();\n      } else {\n        stockValue = value;\n      }\n\n      let startDate = Math.round(new Date().getTime() / 1000);\n      let endDate = startDate - 96 * 3600;\n      let checkForExist = false; // Prevents duplicates\n\n      if (this.state.search_stockArray.includes(stockValue)) {\n        alert(\"Already exists\");\n        document.querySelector(\".stock-code__value\").value = '';\n      } else {\n        checkForExist = true;\n      }\n\n      const table_response = await stock.get('/quote', {\n        params: {\n          symbol: stockValue,\n          token: 'bqhq9i7rh5rbubolrqd0'\n        }\n      });\n\n      if (table_response) {\n        this.setState({\n          loading_api: true\n        });\n      }\n\n      const graph_response = await stock.get('/stock/candle', {\n        params: {\n          symbol: stockValue,\n          resolution: 5,\n          from: endDate,\n          to: startDate,\n          token: 'bqhq9i7rh5rbubolrqd0'\n        }\n      });\n      this.setState({\n        search_stockArray: this.state.search_stockArray.concat(stockValue)\n      }, () => {\n        if (checkForExist) {\n          if (table_response.data.c == 0 && table_response.data.h == 0 && table_response.data.l == 0 && table_response.data.o == 0 && table_response.data.pc == 0 && table_response.data.t == 0) {\n            this.props.sendSearchGraphResult(\"no_data\", '');\n          } else {\n            this.props.sendSearchGraphResult(true, {\n              stockValue: stockValue,\n              response: graph_response.data\n            });\n            this.props.sendSearchResult(table_response.data);\n            this.setState({\n              loading_api: false\n            });\n          }\n\n          document.querySelector(\".stock-code__value\").value = '';\n        }\n\n        ;\n      });\n    };\n\n    this.validateBtn = val => {\n      let btnDOM = document.querySelector(\".btn-search\");\n      val === '' || val.length > 4 ? btnDOM.disabled = true : btnDOM.disabled = false;\n    };\n  }\n\n  // @desc: componentDidMount disables the button search when page loads.\n  componentDidMount() {\n    document.querySelector(\".btn-search\").disabled = true;\n\n    if (localStorage.getItem(\"historyStockArray\") !== null) {\n      let lsArray = JSON.parse(localStorage.getItem(\"historyStockArray\"));\n\n      if (window.confirm(\"You have saved stocks. Would you like to load them?\")) {\n        for (var i = 0; i < lsArray.length; i++) {\n          this.sendSearchResult(false, lsArray[i]);\n        }\n      } else {\n        localStorage.removeItem(\"historyStockArray\");\n      }\n\n      ;\n    }\n\n    ;\n  }\n\n  // @desc: componentDidUpdate checks for the value of button and removes\n  //        the disabled state.\n  componentDidUpdate() {\n    if (document.querySelector(\".btn-search\").value === '') {\n      document.querySelector(\".btn-search\").disabled = true;\n    }\n  } // @desc: when the button is pressed, this runs the API call which checks\n  //        for the user's input of the stock code and gets the latest value\n  //        by looking at it's current date and 24 hours of endDate. This calls\n  //        the tableData and graphData and sends it back up to App.js as props.\n  //        It also makes the input null, and also checks if the stock code exists\n  //        within the API.\n\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card card-container search\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"h6 mb-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 21\n      }\n    }, \"Search Stock Code:\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control stock-code__value\",\n      placeholder: \"Stock Code (e.g. AAPL)\",\n      onKeyUp: e => this.validateBtn(e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-secondary w-100 btn-search\",\n      onClick: () => this.sendSearchResult(true, ''),\n      disabled: this.loading_api,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }\n    }, \"Search Results\", /*#__PURE__*/React.createElement(FaSearch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 170\n      }\n    }))));\n  }\n\n}\n\n;\nexport default SearchCard;","map":{"version":3,"sources":["/Users/zhigangdeng/Projects/react-stock-dashboard/src/components/SearchCard.js"],"names":["React","stock","FaSearch","SearchCard","Component","state","search_stockArray","loading_api","sendSearchResult","torf","value","stockValue","document","querySelector","toUpperCase","startDate","Math","round","Date","getTime","endDate","checkForExist","includes","alert","table_response","get","params","symbol","token","setState","graph_response","resolution","from","to","concat","data","c","h","l","o","pc","t","props","sendSearchGraphResult","response","validateBtn","val","btnDOM","length","disabled","componentDidMount","localStorage","getItem","lsArray","JSON","parse","window","confirm","i","removeItem","componentDidUpdate","render","e","target"],"mappings":"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","sourcesContent":["import React from 'react';\nimport stock from '../apis/stock';\nimport '../css/SearchCard.css';\nimport '../css/styles.css';\nimport { FaSearch } from 'react-icons/fa'\n\nclass SearchCard extends React.Component{\n\n    state = {\n        search_stockArray: [],\n        loading_api: false\n    };\n\n    // @desc: componentDidMount disables the button search when page loads.\n    componentDidMount(){\n        document.querySelector(\".btn-search\").disabled = true;\n\n        if(localStorage.getItem(\"historyStockArray\") !== null){\n            let lsArray = JSON.parse(localStorage.getItem(\"historyStockArray\"));\n            if(window.confirm(\"You have saved stocks. Would you like to load them?\")){\n                for(var i = 0; i < lsArray.length; i++){\n                    this.sendSearchResult(false, lsArray[i])\n                }\n            }else{\n                localStorage.removeItem(\"historyStockArray\");\n            };\n        };\n    };\n\n    // @desc: componentDidUpdate checks for the value of button and removes\n    //        the disabled state.\n    componentDidUpdate(){\n        if(document.querySelector(\".btn-search\").value === ''){\n            document.querySelector(\".btn-search\").disabled = true;\n        }\n    }\n\n    // @desc: when the button is pressed, this runs the API call which checks\n    //        for the user's input of the stock code and gets the latest value\n    //        by looking at it's current date and 24 hours of endDate. This calls\n    //        the tableData and graphData and sends it back up to App.js as props.\n    //        It also makes the input null, and also checks if the stock code exists\n    //        within the API.\n    sendSearchResult = async (torf, value) => {\n        let stockValue;\n        if(torf){\n            stockValue = document.querySelector(\".stock-code__value\").value.toUpperCase();\n        }else{\n            stockValue = value;\n        }\n\n        let startDate = Math.round(new Date().getTime() / 1000);\n        let endDate = startDate - (96 * 3600);\n        let checkForExist = false;\n\n        // Prevents duplicates\n        if(this.state.search_stockArray.includes(stockValue)){\n            alert(\"Already exists\");\n            document.querySelector(\".stock-code__value\").value = '';\n        }else{\n            checkForExist = true;\n        }\n\n        const table_response = await stock.get('/quote', {\n            params: {\n              symbol: stockValue,\n              token: 'bqhq9i7rh5rbubolrqd0'\n            }\n        });\n\n        if(table_response){\n            this.setState({ loading_api: true });\n        }\n\n        const graph_response = await stock.get('/stock/candle', {\n            params: {\n              symbol: stockValue,\n              resolution: 5,\n              from: endDate,\n              to: startDate,\n              token: 'bqhq9i7rh5rbubolrqd0'\n            }\n        });\n        \n        this.setState({\n            search_stockArray: this.state.search_stockArray.concat(stockValue),\n        }, () => {\n            if(checkForExist){\n                if(table_response.data.c == 0 && table_response.data.h == 0 && table_response.data.l == 0 && table_response.data.o == 0 && table_response.data.pc == 0 && table_response.data.t == 0){\n                    this.props.sendSearchGraphResult(\"no_data\", '');\n                }else{\n                    this.props.sendSearchGraphResult(true, {stockValue: stockValue, response: graph_response.data});\n                    this.props.sendSearchResult(table_response.data);\n                    this.setState({ loading_api: false });\n                }\n                document.querySelector(\".stock-code__value\").value = '';\n            };\n        });\n    };\n\n    // @desc: validateBtn checks for the onKeyUp change of the input and disables\n    //        or removes the disable of the button.\n\n    // @param: val => string of the input\n    validateBtn = (val) => {\n        let btnDOM = document.querySelector(\".btn-search\");\n        val === '' || val.length > 4 ? btnDOM.disabled = true : btnDOM.disabled = false;\n    };\n\n    render(){\n        return (\n            <div className=\"card card-container search\">\n                <div className=\"card-body\">\n                    <h2 className=\"h6 mb-0\">Search Stock Code:</h2>\n                    <input type=\"text\" \n                           className=\"form-control stock-code__value\" \n                           placeholder=\"Stock Code (e.g. AAPL)\" \n                           onKeyUp={ (e) => this.validateBtn(e.target.value) }>\n                    </input>\n                    <button className=\"btn btn-secondary w-100 btn-search\" onClick={ () => this.sendSearchResult(true, '') } disabled={ this.loading_api }>Search Results<FaSearch /></button>\n                </div>\n            </div>\n        );\n    };\n};\n\nexport default SearchCard;"]},"metadata":{},"sourceType":"module"}